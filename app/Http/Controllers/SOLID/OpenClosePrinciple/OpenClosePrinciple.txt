NguyÃªn Táº¯c Má»Ÿ/ÄÃ³ng (Open/Closed Principle)
CÃ¡c lá»›p nÃªn má»Ÿ Ä‘á»ƒ má»Ÿ rá»™ng nhÆ°ng Ä‘Ã³ng Ä‘á»ƒ sá»­a Ä‘á»•i.
Ã tÆ°á»Ÿng chÃ­nh cá»§a nguyÃªn táº¯c nÃ y lÃ  giá»¯ cho mÃ£ hiá»‡n cÃ³ khÃ´ng bá»‹ há»ng khi báº¡n triá»ƒn khai cÃ¡c tÃ­nh
nÄƒng má»›i.
MÃ¬nh nghÄ© Ä‘Ã¢y lÃ  má»™t nguyÃªn táº¯c khÃ¡ dá»… hiá»ƒu. MÃ¬nh hay nÃ³i vui vá»›i Ä‘á»“ng nghiá»‡p: â€œCÃ¡i gÃ¬ Ä‘ang cháº¡y
rá»“i thÃ¬ Ä‘á»«ng sá»­a nÃ³â€ ğŸ˜€. TÆ° tÆ°á»Ÿng cá»§a nguyÃªn táº¯c nÃ y pháº§n nÃ o pháº£n Ã¡nh cÃ¢u nÃ³i Ä‘Ã¹a trÃªn: chÃºng ta
cáº§n háº¡n cháº¿ tá»‘i Ä‘a sá»­a code cÅ©, mÃ  Æ°u tiÃªn má»Ÿ rá»™ng, vÃ  â€œthay tháº¿â€ náº¿u cÃ³ thá»ƒ. HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n
Ä‘ang lÃ m viá»‡c vá»›i má»™t website ThÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­. Má»™t ngÃ y Ä‘áº¹p trá»i, cÃ´ng ty yÃªu cáº§u báº¡n pháº£i
thÃªm má»™t phÆ°Æ¡ng thá»©c váº­n chuyá»ƒn má»›i. Sáº½ lÃ  Ã¡c má»™ng náº¿u má»i thá»© liÃªn quan Ä‘áº¿n phÆ°Æ¡ng thá»©c váº­n
chuyá»ƒn Ä‘á»u Ä‘Æ°á»£c viáº¿t chung trong class Order (ÄÆ¡n hÃ ng). Báº¡n sáº½ pháº£i tÃ¡c Ä‘á»™ng trá»±c tiáº¿p vÃ o code
cÅ©, cá»‘ gáº¯ng hy vá»ng ráº±ng mÃ¬nh khÃ´ng lÃ m há»ng Ä‘iá»u gÃ¬ (vÃ  cháº¯c cháº¯n lÃ  nÃ³ sáº½ há»ng rá»“i, Ä‘á»‹nh lÃ½
Murphy mÃ  ğŸ˜€). LÃºc nÃ y, Strategy pattern sáº½ giáº£i cá»©u báº¡n: chÃºng ta sáº½ trÃ­ch xuáº¥t cÃ¡c phÆ°Æ¡ng thá»©c
váº­n chuyá»ƒn nÃ y sang cÃ¡c class chá»‹u trÃ¡ch nhiá»‡m riÃªng biá»‡t, implement chung interface Ä‘á»ƒ dá»… dÃ ng
thay Ä‘á»•i khi cáº§n.
Báº¡n cÃ³ thá»ƒ tham kháº£o vÃ­ dá»¥ minh hoáº¡ dÆ°á»›i Ä‘Ã¢y:
Giáº£ sá»­ chÃºng ta cÃ³ má»™t há»‡ thá»‘ng tÃ­nh toÃ¡n chi phÃ­ váº­n chuyá»ƒn cho cÃ¡c loáº¡i phÆ°Æ¡ng tiá»‡n khÃ¡c nhau.
Ban Ä‘áº§u, há»‡ thá»‘ng chá»‰ há»— trá»£ váº­n chuyá»ƒn báº±ng xe táº£i:
<?php
class TruckShipping {
public function calculateCost($weight) {
return $weight * 1.5;
}
}
class ShippingService {
private $shipping;
public function __construct(TruckShipping $shipping) {
$this->shipping = $shipping;
}
public function calculate($weight) {
return $this->shipping->calculateCost($weight);
}
}
// Sá»­ dá»¥ng ShippingService
$truckShipping = new TruckShipping();
$shippingService = new ShippingService($truckShipping);
echo $shippingService->calculate(100); // Output: 150
Khi cáº§n thÃªm loáº¡i phÆ°Æ¡ng tiá»‡n váº­n chuyá»ƒn má»›i nhÆ° tÃ u há»a, thay vÃ¬ sá»­a Ä‘á»•i cÃ¡c class hiá»‡n cÃ³, chÃºng
ta sáº½ má»Ÿ rá»™ng há»‡ thá»‘ng báº±ng cÃ¡ch sá»­ dá»¥ng interface:
<?php
interface ShippingMethod {
public function calculateCost($weight);
}
class TruckShipping implements ShippingMethod {
public function calculateCost($weight) {
return $weight * 1.5;
}
}
class TrainShipping implements ShippingMethod {
public function calculateCost($weight) {
return $weight * 1.2;
}
}
class ShippingService {
private $shipping;
public function __construct(ShippingMethod $shipping) {
$this->shipping = $shipping;
}
public function calculate($weight) {
return $this->shipping->calculateCost($weight);
}
}
// Sá»­ dá»¥ng ShippingService vá»›i TruckShipping
$truckShipping = new TruckShipping();
$shippingService = new ShippingService($truckShipping);
echo $shippingService->calculate(100); // Output: 150
// Sá»­ dá»¥ng ShippingService vá»›i TrainShipping
$trainShipping = new TrainShipping();
$shippingService = new ShippingService($trainShipping);
echo $shippingService->calculate(100); // Output: 120
Trong vÃ­ dá»¥ trÃªn:
â— Interface ShippingMethod Ä‘á»‹nh nghÄ©a phÆ°Æ¡ng thá»©c calculateCost mÃ  cÃ¡c class cá»¥ thá»ƒ cáº§n triá»ƒn
khai.
â— TruckShipping vÃ  TrainShipping triá»ƒn khai interface ShippingMethod.
Class ShippingService sá»­ dá»¥ng dependency injection Ä‘á»ƒ nháº­n má»™t Ä‘á»‘i tÆ°á»£ng ShippingMethod.
Báº±ng cÃ¡ch nÃ y, náº¿u chÃºng ta cáº§n thÃªm phÆ°Æ¡ng thá»©c váº­n chuyá»ƒn má»›i (vÃ­ dá»¥: AirShipping), chÃºng ta
chá»‰ cáº§n táº¡o má»™t class má»›i triá»ƒn khai ShippingMethod mÃ  khÃ´ng cáº§n thay Ä‘á»•i cÃ¡c class hiá»‡n cÃ³. Äiá»u
nÃ y giÃºp há»‡ thá»‘ng cá»§a chÃºng ta dá»… má»Ÿ rá»™ng vÃ  duy trÃ¬, tuÃ¢n thá»§ theo nguyÃªn táº¯c ÄÃ³ng / Má»Ÿ.
